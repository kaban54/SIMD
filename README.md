# SIMD

## Цель ##

Анализ оптимизаций сделанных с помощью SIMD инструкций


В ходе работы рассматривались две задачи: построение множества Мандельброта и альфа блендинг.

## 1. Построение множества мандельброта ##

Были протестированны две версии программы, рисующей множество Мандельброта,
и измерено значение FPS для каждой версии.

## Результат работы программы ##

![](./result.png)

___________________________________________________________

Все тесты проводилиись на процессоре Intel® Core™ i5-1135G7\
с компилятором gcc версии 11.3.0\
Флаги компиляции: -O3 -mavx2

## Краткое описание версий ##

**v1:**\
В первой версии представлена скалярная реализация,\
т.е. рассчёты проводятся отдельно для каждой точки.

**v2:**\
Во второй версии предсавлена веркотрная реализация,\
в ней используются AVX-инструкции, и вычисления ведутся параллельно для восьми точек

___________________________________________________________

Целью было узнать, во сколько раз оптимизация ускорит программу.

Т.к. оптимизации никак не затрагивали процесс рисования, то
для каждой версии было проведено 3 теста:\
вычисления для каждой точки проводились 1, 10 и 30 раз.\
При этом вывод точки на экран производился только 1 раз.

В таблице представлены значения FPS для разных версий и разного количества повторений
 
Версия   | 1 повторение | 10 повторений | 30 повторений |
---------|--------------|---------------|---------------|
 v1      |  4.8         | 0.48          | 0.16          |
 v2      | 31.4         | 3.40          | 1.14          |
 
Пусть k - коэффициент ускорения.

Тогда\
для  1 повторения k = 6.54\
для 10 повторений k = 7.08\
для 30 повторений k = 7.13

## 2. Alpha blending ##

Далее раассматривалась программа, накладывающая одну картинку на другую с использованием альфа блендинга.

Снова сравнивались две версии программы:\
в первой версии расчёты производились отдельно для каждой точки,\
во второй версии применяются AVX инструкции.

___________________________________________________________

Все тесты проводилиись на процессоре Intel® Core™ i5-1135G7\
с компилятором gcc версии 11.3.0\
Флаги компиляции: -O1 -mavx2

## Результат работы программы ##

Исходные изображения:

![](./back_resized.bmp)
![](./cat_resized.bmp)

Результат наложения:

![](./result_resized.bmp)

## Тесты ##

В таблице представлены значения FPS для разных версий и разного количества повторений
 
Версия   | 100 повторений | 1000 повторений | 10000 повторений |
---------|----------------|-----------------|------------------|
 v1      | 40             | 6.2             | 0.65             |
 v2      | 270            | 46              | 5.11             |
 
Пусть k - коэффициент ускорения.

Тогда\
для 100 повторений k = 6.75\
для 1000 повторений k = 7.42\
для 10000 повторений k = 7.86

Можно заметить что для обеих программ полученное значение k соответствует ожидаемому, т.е. чуть меньше 8.

## Вывод ##

С помощью SIMD инструкций можно в несколько раз ускорить работу некоторых программ,\
при этом компилятор не способен сам производить такие оптимизации.\
Поэтому умение использовать SIMD инструкции является полезным навыком.
